define(["app"],function(e){e.controller("SettleController",["$scope","$timeout","$location","ipCookie","settleService",function(e,t,n,r,i){e.$on("imagePath",function(t,n){e.settle.images=n}),e.toast={upload:!1,message:""},e.settle={openid:r("openid"),images:[]},e.seeCard=function(){i.seeCard(r("openid")).then(function(r){console.log(r),r.length>0?r[0].states?(e.images=r[0].images,n.path("/app/settle/detail")):(e.toast.message="名片正在设计中，请稍候查看",e.toast.upload=!0,t(function(){e.toast.upload=!1},900)):(e.toast.message="名片正在设计中，请稍候查看",e.toast.upload=!0,t(function(){e.toast.upload=!1},900))})},e.submitSettle=function(){if(e.settle.images.length==0){e.toast.message="请先选择照片上传",e.toast.upload=!0,t(function(){e.toast.upload=!1},900);return}i.addFamily(e.settle).then(function(){e.toast.message="添加成功，后台正在设计中，完成后可在此页面查看",e.toast.upload=!0,t(function(){e.toast.upload=!1},900)})}}])});